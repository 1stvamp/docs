<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Juju Documentation - Relations</title>
    <link href="//fonts.googleapis.com/css?family=Ubuntu:400,400italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Ubuntu+Mono:400" rel="stylesheet" type="text/css"/>
    <link href="https://juju.ubuntu.com/wp-content/themes/juju-website/css/reset.css" rel="stylesheet" type="text/css"/>
    <link href="https://juju.ubuntu.com/wp-content/themes/juju-website/css/960.css" rel="stylesheet" type="text/css"/>
    <link href="https://juju.ubuntu.com/wp-content/themes/juju-website/css/base.css" rel="stylesheet" type="text/css"/>
    <link href="https://juju.ubuntu.com/wp-content/themes/juju-website/css/resources.css" rel="stylesheet" type="text/css"/>
    <link href="css/main.css" rel="stylesheet" type="text/css"/>
    <!--[if lt IE 9]>
    <script type="text/javascript" src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body class="resources">
    <header>
      <div class="header-login">
        <ul>
          <li>&nbsp;</li>
        </ul>
      </div>
      <div class="header-navigation">
        <div>
          <nav role="navigation">
            <ul>
              <li class="page_item"><a href="https://juju.ubuntu.com/">Home</a></li>
              <li class="page_item current_page_item"><a href="https://juju.ubuntu.com/">Resources</a></li>
              <li class="page_item"><a href="https://juju.ubuntu.com/">Community</a></li>
              <li class="page_item"><a href="https://juju.ubuntu.com/">Charm Store</a></li>
              <li class="page_item"><a href="https://juju.ubuntu.com/">Events</a></li>
              <li class="page_item"><a href="https://juju.ubuntu.com/">Survey</a></li>
              <li>
                <form id="form-search" method="get" action="/">
                  <fieldset>
                    <input id="input-search" type="text" name="s" value="Search">
                  </fieldset>
                </form>
              </li>
            </ul>
          </nav><a href="https://juju.ubuntu.com/" class="logo-ubuntu"><img src="https://juju.ubuntu.com/wp-content/themes/juju-website/img/logo-ubuntu.png"></a>
        </div>
      </div>
      <div class="header-content">
        <div class="clearfix"><img src="https://juju.ubuntu.com/wp-content/themes/juju-website/img/arrow-nav.png" width="9" height="5" style="left:894px; display: block;" class="arrow-nav">
          <div class="header-navigation-secondary"></div>
          <div class="header-image"></div>
          <h1>Resources</h1>
          <h2>A collection of some of the most important online references for Juju users and developers.</h2>
        </div>
      </div>
    </header>
    <section id="content" class="container-12">
      <div class="grid-12 doc-container">
        <div class="grid-3 doc-navigation">
          <nav role="navigation">
            <h1>User Guide</h1>
            <ul>
              <li class=""><a href="getting-started.html">Getting Started</a></li>
              <li class=" sub"><a href="getting-started.html#intro">Introduction</a></li>
              <li class=" sub"><a href="getting-started.html#install">Installation</a></li>
              <li class=" sub"><a href="config-aws.html">AWS Configuration</a></li>
              <li class=" sub"><a href="config-hpcloud.html">HP Cloud Configuration</a></li>
              <li class=" sub"><a href="config-openstack.html">OpenStack Configuration</a></li>
              <li class=" sub"><a href="config-maas.html">MAAS Configuration</a></li>
              <li class=" sub"><a href="getting-started.html#test">Testing your setup</a></li>
              <li class=""><a href="charms.html">Using Charms</a></li>
              <li class=" sub"><a href="charms.html#intro">What are Charms?</a></li>
              <li class=" sub"><a href="charms-deploying.html">Deploying Services</a></li>
              <li class=" sub"><a href="charms-constraints.html">Using constraints</a></li>
              <li class=" sub"><a href="charms-config.html">Service Configuration</a></li>
              <li class=" sub"><a href="charms-relations.html">Service Relationships</a></li>
              <li class=" sub"><a href="charms-exposing.html">Exposing Services</a></li>
              <li class=" sub"><a href="charms-scaling.html">Scaling Services</a></li>
              <li class=" sub"><a href="charms-destroy.html">Destroying Services</a></li>
            </ul>
            <h1>Charm Authors</h1>
            <ul></ul>
            <li class=""><a href="authors-charm-anatomy.html">Anatomy of a charm</a></li>
            <li class=""><a href="authors-charm-writing.html">Writing a charm</a></li>
            <li class=" sub"><a href="authors-subordinate-services.html">Subordinate services</a></li>
            <li class=" sub"><a href="authors-implicit-relations.html">Implicit Relations</a></li>
            <li class=" sub"><a href="authors-testing.html">Charm Testing</a></li>
            <li class=" sub"><a href="authors-hooks.html">Hook debugging</a></li>
            <li class=""><a href="authors-charm-store.html">The Juju Charm Store</a></li>
            <li class=" sub"><a href="authors-charm-policy.html">Charm store policy</a></li>
            <li class=" sub"><a href="authors-charm-best-practice.html">Best practices</a></li>
            <li class=" sub"><a href="authors-charm-quality.html">Charm Quality Rating</a></li>
            <li class=" sub"><a href="authors-charm-icon.html">Charm Icons</a></li>
            <h1>Reference</h1>
            <ul>
              <li class="sub"><a href="commands.html">Juju commands</a></li>
              <li class="sub"><a href="glossary.html">Glossary</a></li>
              <li class="sub"><a href="contributing.html">Contribute to the Docs!</a></li>
            </ul>
          </nav>
        </div>
        <div class="grid-9 doc-content">
          <article>
            <section id ="charms-relations">
              <h1>Managing Relationships</h1>
              <p>Few services you might want to run can do so completely independently - most of them rely on some other software components to be present and running too (e.g. a database). There would be little point in Juju making it supremely easy to deploy services if it didn't also make it easy to connect them up to services they need to get running! The Juju magic in this case involves the <strong>hooks</strong> built in to each charm which allow them to communicate. Unless you are writing charms, there is no need to go into detail on hooks, but these are the parts that make creating relationships between services so easy.</p>
               <p>The charm for WordPress, for example, knows that it requires a database. It therefore has some code to deal with creating that connection and configuring the WordPress instance appropriately when it is told which database to connect to. Similarly, the MySQL charm knows that it is a database, and has code to create different types of database depending on what is required. The act of joining these services together causes this code to run, the WordPress charm saying what tables, users and data it requires, and the MySQL charm fulfilling that and acknowledging the task. As you will see though, adding a relationship is much easier than even this brief explanation.</p>
              <h1>Creating Relations</h1>
              <p>Creating relationships is usually very straightforward. Simply deploy the two services:</p>
              <pre><code>juju deploy wordpress
              juju deploy mysql
              </code></pre>
              <p>Then you create the relationship by specifying these two services with the <strong>add-relation</strong> command:</p>
              <code><pre>juju add-relation mysql wordpress</code></pre>
              <p>These services will then communicate and establish an appropriate connection, in this case WordPress using the available MySQL service for its database requirement, and MySQL generating and providing the necessary tables required for WordPress.</p>
              <p>In some cases, there may be ambiguity about how the services should connect. For example, in the case of specifying a database for the Mediawiki charm.</p>
              <pre><code>juju add-relation mediawiki mysql -e hpc
              error: ambiguous relation: "mediawiki mysql" could refer to "mediawiki:db mysql:db"; "mediawiki:slave mysql:db"
              </code></pre>
              <p> the soloution in these cases is to specify the nature of the relation using the hook identifier. In this case, we want MySQL to provide the backend database for mediawiki, so this is what we need to enter:</p>
              <pre><code>juju add-relation mediawiki:db mysql</code></pre>
              <p>we can check the output from 'juju status' to make sure the correct relationship has been established:</p>
              <pre><code>juju status -e hpc
machines:
&nbsp;&nbsp;"0":
&nbsp;&nbsp;&nbsp;&nbsp;agent-state: started
&nbsp;&nbsp;&nbsp;&nbsp;agent-version: 1.10.0
&nbsp;&nbsp;&nbsp;&nbsp;dns-name: 15.185.88.51
&nbsp;&nbsp;&nbsp;&nbsp;instance-id: "1736045"
&nbsp;&nbsp;&nbsp;&nbsp;series: precise
&nbsp;&nbsp;"1":
&nbsp;&nbsp;&nbsp;&nbsp;agent-state: started
&nbsp;&nbsp;&nbsp;&nbsp;agent-version: 1.10.0
&nbsp;&nbsp;&nbsp;&nbsp;dns-name: 15.185.89.204
&nbsp;&nbsp;&nbsp;&nbsp;instance-id: "1736065"
&nbsp;&nbsp;&nbsp;&nbsp;series: precise
&nbsp;&nbsp;"3":
&nbsp;&nbsp;&nbsp;&nbsp;agent-state: started
&nbsp;&nbsp;&nbsp;&nbsp;agent-version: 1.10.0
&nbsp;&nbsp;&nbsp;&nbsp;dns-name: 15.185.89.236
&nbsp;&nbsp;&nbsp;&nbsp;instance-id: "1736119"
&nbsp;&nbsp;&nbsp;&nbsp;series: precise
services:
&nbsp;&nbsp;mediawiki:
&nbsp;&nbsp;&nbsp;&nbsp;charm: cs:precise/mediawiki-8
&nbsp;&nbsp;&nbsp;&nbsp;exposed: false
&nbsp;&nbsp;&nbsp;&nbsp;relations:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;db:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- mysql
&nbsp;&nbsp;&nbsp;&nbsp;units:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mediawiki/0:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;agent-state: pending
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;agent-version: 1.10.0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;machine: "3"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public-address: 15.185.89.236
&nbsp;&nbsp;mysql:
&nbsp;&nbsp;&nbsp;&nbsp;charm: cs:precise/mysql-24
&nbsp;&nbsp;&nbsp;&nbsp;exposed: false
&nbsp;&nbsp;&nbsp;&nbsp;relations:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- mysql
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;db:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- mediawiki
&nbsp;&nbsp;&nbsp;&nbsp;units:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mysql/0:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;agent-state: started
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;agent-version: 1.10.0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;machine: "1"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public-address: 15.185.89.204
</code></pre>
<h1>Removing Relations</h1>
<p>There are times when a relationship just isn't working and it is time to move on. Fortunately, it is a simple single-line command to break off these relationships:</p>
<pre><code>juju destroy-relation mediawiki mysql</code></pre>



            </section>
          </article>
        </div>
      </div>
    </section>
    <div class="shadow"></div>
    <footer>
      <div>
        <nav role="navigation" class="clearfix">
          <ul>
            <li><a href="https://juju.ubuntu.com/get-started">Get started</a></li>
            <li class="page_item"><a href="https://juju.ubuntu.com/get-started/local/">Local</a></li>
            <li class="page_item"><a href="https://juju.ubuntu.com/get-started/amazon/">Amazon Web Services</a></li>
            <li class="page_item"><a href="https://juju.ubuntu.com/get-started/hp-cloud/">HP Cloud</a></li>
            <li class="page_item"><a href="https://juju.ubuntu.com/get-started/rackspace/">Rackspace</a></li>
            <li class="page_item"><a href="https://juju.ubuntu.com/get-started/openstack/">Openstack</a></li>
            <li class="page_item"><a href="https://juju.ubuntu.com/get-started/maas/">MAAS</a></li>
          </ul>
          <ul>
            <li><a href="https://juju.ubuntu.com/resources">Resources</a></li>
            <li><a href="https://juju.ubuntu.com/docs">Documentation</a></li>
            <li><a href="https://juju.ubuntu.com/resources/videos">Videos</a></li>
            <li><a href="http://uistage.jujucharms.com:8080/">Juju GUI Demo</a></li>
          </ul>
          <ul>
            <li><a href="https://juju.ubuntu.com/community">Community</a></li>
            <li class="page_item"><a href="https://juju.ubuntu.com/community/juju-blog/">Blog</a></li>
            <li class="page_item"><a href="https://juju.ubuntu.com/community/weekly-charm-meeting/">Charm Meetings</a></li>
            <li class="page_item"><a href="https://juju.ubuntu.com/community/charmers/">Charmers</a></li>
            <li class="page_item"><a href="https://lists.ubuntu.com/mailman/listinfo/juju">Mailing List</a></li>
            <li class="page_item"><a href="http://webchat.freenode.net/?channels=juju">Chat</a></li>
            <li class="page_item"><a href="http://askubuntu.com/questions/tagged/juju?sort=faq&amp;amp;pagesize=50">FAQ</a></li>
          </ul>
          <ul class="last">
            <li><a href="https://launchpad.net/juju">Code</a></li>
            <li><a href="https://launchpad.net/juju-core">Juju Core</a></li>
            <li><a href="https://launchpad.net/charms">Charms</a></li>
          </ul>
        </nav>
      </div>
    </footer>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/jquery-ui.min.js"></script>
    <script src="//d38yea5fb4e2oh.cloudfront.net/jquery.stacktack.min.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
  </body>
</html>
